<!DOCTYPE html>
<html lang="zh-tw">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href='css/style.css'>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="shortcut icon" type="image/png" href="./img/shortcut_logo.png">
    <title>å¡«å¯«è³‡æ–™ SHOPPING_CART - æ³¢æ³¢å‹•ç‰©é†«é™¢</title>
</head>

<body class="SHOPPINGCARTP2" id="SHOPPINGCART2VUE" onload="showMember()">
    <!-- =============== å…±ç”¨å…ƒä»¶ =============== -->

    <!-- ===== æœƒå“¡å½ˆçª— ===== -->
    <!-- user_popup -->
    @@include('./layout/user_popup.html')
    <!-- user_popup end -->

    <!-- =============== header =============== -->
    <!-- header -->
    @@include('./layout/header.html')
    <!-- header end -->

    <!-- =============== ç¶²é å…§å®¹ =============== -->

    <section class="SHOPPINGCARTP2BG BACKGROUND">
        <div class="BG_CLOUDS">
            <div class="BG_CLOUD CLOUD_1">
                <img class="BG_CLOUD_IMG1" src="./img/CLOUD_BG.png" alt="">
            </div>
            <div class="BG_CLOUD CLOUD_2">
                <img class="BG_CLOUD_IMG2" src="./img/CLOUD_BG.png" alt="">
            </div>
        </div>
        <!-- ====================================================================================== -->

        <section class="CART02_SLOGANALL WRAPPER">
            <span>
                <img src="./img/shopping_cart/cartp2_slogan01.png" alt="" class="SLOGAN02">
                <img src="./img/shopping_cart/cartp2_slogan01M.png" alt="" class="SLOGAN02M">
            </span>
            <span class="CAT ANI"></span>
        </section>

        <!-- ======================================éºµåŒ…å±‘========================================== -->

        <section class="BREAD WRAPPER">
            <a href="homepage.html">é¦–é </a>
            /
            <a>è³¼ç‰©è»Š</a>
        </section>

        <!-- ====================================è³¼ç‰©è»Šç¬¬äºŒæ­¥é©Ÿ=========================================== -->
        <section class="SHOPPINGCART_STEP WRAPPER">
            <section class="SHOPPINGCART_STEPAREA">
                <section class="SHOPPINGCART_ARCONE">
                    <div class="ARC_TITLE">1</div>
                    <p>è³¼ç‰©è»Š</p>
                </section>
                <section class="SHOPPINGCART_ARCTWO">
                    <div class="ARC_TITLE">2</div>
                    <p>å¡«å¯«è³‡æ–™</p>
                </section>
                <section class="SHOPPINGCART_ARCTHREE">
                    <div class="ARC_TITLE">3</div>
                    <p>çµå¸³æˆåŠŸ</p>
                </section>
            </section>
        </section>
        <!-- ========================================åƒ¹æ ¼å•†å“æ˜ç´°================================================= -->

        <section class="SHOPPINGCARTP2_ORDER WRAPPER">
            <section class="SHOPPINGCARTP2_ORDERTEXTALL">
                <section class="SHOPPINGCARTP2_ORDERTEXT">
                    <p>åˆè¨ˆï¼šNT${{totalAmount}}</p>
                    <span>è³¼ç‰©è»Š:({{ cartItemCount }}ä»¶)
                        <span class="SHOPPINGCARTP2_ORDERARR">
                            <img src="./img/shopping/ğŸ¦† icon _angle-right-b_.svg" alt="">
                        </span>
                    </span>
                </section>

                <section class="SHOPPINGCART_ALLLIST">

                    <section class="SHOPPINGCART_ITEMFORM ORDERITEM">
                        <section class="SHOPPINGCART_ITEMtitle">
                            <span class="ITEM_PRODUCT--W">å•†å“</span>
                            <span class="ITEM_PRICE--W">å–®ä»¶åƒ¹æ ¼</span>
                            <span class="ITEM_COUNT--W">æ•¸é‡</span>
                            <span class="ITEM_SUBTOTAL--W">å°è¨ˆ</span>
                        </section>

                        <section class="SHOPPINGCART_ITEM" v-for="(item, index) in shoppingCartItems" :key="index">
                            <section class="ITEM_PRODUCT ITEM_PRODUCT--W">
                                <section class="ITEM_PRODUCT--IMG">
                                    <img :src="getFirstImage(item.IMG_SOURCE_ARRAY)" alt="">
                                </section>
                                <span>{{ item.PRODUCT_TITLE }}</span>
                            </section>
                            <section class="ITEM_PRICE ITEM_PRICE--W">
                                <p>NTï¼„{{ item.PRODUCT_PRICE }}</p>
                            </section>
                            <section class="ITEM_COUNT ITEM_COUNT--W">
                                <span class="ITEM_COUNT--NUM">{{ item.quantity }}</span>
                            </section>
                            <section class="ITEM_SUBTOTAL ITEM_SUBTOTAL--W">
                                <p>NTï¼„{{ item.PRODUCT_PRICE * item.quantity }}</p>
                            </section>
                        </section>
                    </section>
                </section>

                <!-- ========================================æ‰‹æ©Ÿæ¿LIST================================================== -->

                <section class="SHOPPINGCART_ITEMLIST--M">
                    <section class="SHOPPINGCART_ITEM--M" v-for="(item, index) in shoppingCartItems" :key="index">
                        <section class="SHOPPINGCART_ITEMIMG--M">
                            <img :src="getFirstImage(item.IMG_SOURCE_ARRAY)" alt="">
                        </section>
                        <section class="SHOPPINGCART_ITEMWORD--M">
                            <section class="SHOPPINGCART_ITEMWORD--TOPM">
                                <section class="SHOPPINGCART_ITEMWORD--NAMEM">
                                    <span>{{ item.PRODUCT_TITLE }}</span>
                                </section>

                            </section>
                            <section class="SHOPPINGCART_ITEMWORD--BOTTOMM">
                                <section class="SHOPPINGCART_ITEMWORD--COUNTM">
                                    <span class="ITEM_COUNT--NUM">æ•¸é‡:{{ item.quantity }}</span>
                                </section>
                                <section class="SHOPPINGCART_ITEMWORD--PRICEM">
                                    <p>NTï¼„{{ item.PRODUCT_PRICE * item.quantity }}</p>
                                </section>
                            </section>
                        </section>
                    </section>
                </section>

            </section>

            <!-- =========================================gè³¼ç‰©è»ŠP2è¡¨å–®å·¦ä¸Š=============================================== -->

            <section class="SHOPPINGCARTP2_TEXT">
                <section class="SHOPPINGCARTP2_TEXT--TOP">
                    <section class="SHOPPINGCARTP2_STEPTEXT--FORM P2MEMBER COL-6 RWD-COL-12">
                        <section class="SHOPPINGCARTP2_STEPTEXT--TITLE">
                            <span>æœƒå“¡è³‡æ–™</span>
                        </section>
                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="MEMBERNAME" class="INPUT">å§“å<br>
                                <input type="text" id="MEMBERNAME" class="INPUTENTER" placeholder="è«‹è¼¸å…¥æœƒå“¡åç¨±" readonly>
                            </label>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="MEMBERMAIL" class="INPUT">é›»å­ä¿¡ç®±<br>
                                <input type="text" id="MEMBERMAIL" class="INPUTENTER" placeholder="è«‹è¼¸å…¥é›»å­ä¿¡ç®±" readonly>
                            </label>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="MEMBERPHONE" class="INPUT">é€£çµ¡é›»è©±<br>
                                <input type="text" id="MEMBERPHONE" class="INPUTENTER" placeholder="è«‹è¼¸å…¥é›»è©±è™Ÿç¢¼" readonly>
                            </label>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <span>è‹¥æœƒå“¡è³‡æ–™æœ‰èª¤ï¼Œå»ºè­°å‰å¾€æœƒå“¡ä¸­å¿ƒé€²è¡Œä¿®æ”¹ï¼Œä»¥é˜²ä¹‹å¾Œä»å¸¶å…¥éŒ¯èª¤è³‡è¨Šã€‚</span>
                            <div>
                                <a href="./member_center.html">
                                <button class="BTN">å‰å¾€æœƒå“¡ä¸­å¿ƒ</button>
                                </a>
                            </div>
                        </section>

                    </section>

                    <!-- ==========================================è³¼ç‰©è»ŠP2è¡¨å–®å³ä¸Š============================================= -->


                    <section class="SHOPPINGCARTP2_STEPTEXT--FORM P2MEMBER COL-6 RWD-COL-12">
                        <section class="SHOPPINGCARTP2_STEPTEXT--TITLE">
                            <span>æ”¶ä»¶è³‡æ–™</span>
                            <label for="samemember" class="SAMEMEMBER">
                                <input type="checkbox" value="ture" id="samemember" name="MEMBERINFO">
                                <span class="CHECKMEMBER"></span>
                                åŒæœƒå“¡è³‡æ–™
                            </label>
                        </section>
                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="RECIPIENT" class="INPUT">å§“å
                                <span class="INPUTERROR">å§“åä¸å¯ç‚ºç©ºç™½</span>
                                <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºå§“å</span><br>
                                <input type="text" id="RECIPIENT" class="INPUTENTER" placeholder="è«‹è¼¸å…¥æ”¶ä»¶äººåç¨±">
                            </label>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="CARTINBOX" class="INPUT">é›»å­ä¿¡ç®±
                                <span class="INPUTERROR">ä¿¡ç®±ä¸å¯ç‚ºç©ºç™½</span>
                                <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºé›»å­ä¿¡ç®±</span><br>
                                <input type="text" id="CARTINBOX" class="INPUTENTER" placeholder="è«‹è¼¸å…¥æ”¶ä»¶äººé›»å­ä¿¡ç®±">
                            </label>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="RECIPIENTPHONE" class="INPUT">é€£çµ¡æ‰‹æ©Ÿ
                                <span class="INPUTERROR">é€£çµ¡é›»è©±ä¸å¯ç‚ºç©ºç™½</span>
                                <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºé€£çµ¡é›»è©±</span><br>
                                <input type="text" id="RECIPIENTPHONE" class="INPUTENTER" placeholder="è«‹è¼¸å…¥æ”¶ä»¶äººé›»è©±è™Ÿç¢¼">
                            </label>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <span>é¸æ“‡é–€å¸‚</span>
                            <div>
                                <button class="BTN">æœå°‹é–€å¸‚</button>
                            </div>
                        </section>

                    </section>



                </section>



                <section class="SHOPPINGCARTP2_TEXT--BOTTOM">


                    <!-- =========================================è³¼ç‰©è»ŠP2è¡¨å–®å·¦ä¸‹=============================================== -->

                    <section class="SHOPPINGCARTP2_STEPTEXT--FORM COL-6 RWD-COL-12">
                        <section class="SHOPPINGCARTP2_STEPTEXT--TITLE">
                            <span>ä»˜æ¬¾è³‡æ–™</span>
                        </section>

                        <span class="SHOPPINGCARTP2_STEPTEXT--REMIND">
                            å·²é¸æ“‡çš„é€è²¨æ–¹å¼ï¼š7-11åº—åˆ°åº—å–è²¨ä»˜æ¬¾
                        </span>
                        <section class="SHOPPINGCARTP2_STEPTEXT--HALF">

                            <section class="SHOPPINGCARTP2_STEPTEXT--HALFINPUT">
                                <label for="CARDOWNER" class="INPUT">æŒå¡äººå§“å
                                    <span class="INPUTERROR">å§“åä¸å¯ç‚ºç©ºç™½</span>
                                    <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºå§“å</span><br>
                                    <input type="text" id="CARDOWNER" class="INPUTENTER" placeholder="è«‹è¼¸å…¥æŒå¡äººå§“å" :disabled="paymentId === '2'">
                                </label>
                            </section>

                            <section class="SHOPPINGCARTP2_STEPTEXT--HALFINPUT">
                                <label for="CARDNUMBER" class="INPUT">ä¿¡ç”¨å¡å¡è™Ÿ
                                    <span class="INPUTERROR">å¡è™Ÿä¸å¯ç‚ºç©ºç™½</span>
                                    <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºå¡è™Ÿ</span><br>
                                    <input type="text" id="CARDNUMBER" class="INPUTENTER"
                                        placeholder="0000-0000-0000-0000" :disabled="paymentId === '2'">
                                </label>
                            </section>

                            <section class="SHOPPINGCARTP2_STEPTEXT--HALFINPUT">
                                <label for="CARDEXPIRYDATE" class="INPUT">æœ‰æ•ˆæ—¥æœŸ
                                    <span class="INPUTERROR">æ—¥æœŸä¸å¯ç‚ºç©ºç™½</span>
                                    <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºæ—¥æœŸ</span><br>
                                    <input type="text" id="CARDEXPIRYDATE" class="INPUTENTER" placeholder="MM/YY" :disabled="paymentId === '2'">
                                </label>
                            </section>

                            <section class="SHOPPINGCARTP2_STEPTEXT--HALFINPUT">
                                <label for="CARDCVC" class="INPUT">å®‰å…¨ç¢¼(CVC)
                                    <span class="INPUTERROR">å®‰å…¨ç¢¼ä¸å¯ç‚ºç©ºç™½</span>
                                    <span class="INPUTERROR2">è«‹è¼¸å…¥æ­£ç¢ºå®‰å…¨ç¢¼</span><br>
                                    <input type="text" id="CARDCVC" class="INPUTENTER" placeholder="è«‹è¼¸å…¥ä¸‰ä½æ•¸å®‰å…¨ç¢¼" :disabled="paymentId === '2'">
                                </label>
                            </section>

                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <span
                                class="CREDITREMIND">æˆ‘å€‘ä½¿ç”¨ã€Œç¶ ç•Œç§‘æŠ€ECPayæ”¯ä»˜å¹³å°ç³»çµ±ã€ï¼Œç¶²é å°‡æœƒè½‰å¾€ç¶ ç•Œä¿¡ç”¨å¡æˆæ¬Šé é¢ï¼›äº¤æ˜“å…¨ç¨‹ä½¿ç”¨SSLå®‰å…¨æ©Ÿåˆ¶ï¼Œç¢ºä¿äº¤æ˜“è³‡æ–™ä¸æœƒå¤–æ´©ï¼Œè«‹æ‚¨å®‰å¿ƒä»˜æ¬¾ï¼</span>
                        </section>

                    </section>


                    <!-- =========================================è³¼ç‰©è»ŠP2è¡¨å–®å³ä¸‹=============================================== -->

                    <section class="SHOPPINGCARTP2_STEPTEXT--FORM COL-6 RWD-COL-12">
                        <section class="SHOPPINGCARTP2_STEPTEXT--TITLE">
                            <span>è¨‚å–®å‚™è¨»</span>
                        </section>

                        <section class="SHOPPINGCARTP2_STEPTEXT--INPUT">
                            <label for="MEMO" class="TEXTAREA">å‚™è¨»<br>
                                <textarea id="MEMO" placeholder="æœ‰ä»€éº¼æƒ³å‘Šè¨´è³£å®¶çš„..." class="TEXTAREA_CONTENT"></textarea>
                            </label>
                        </section>

                    </section>

                </section>

            </section>
            <!-- ===================================çµå¸³é æœ€å¾Œ============================================= -->

            <section class="SHOPPINGCARTP2_FINALLINK">
                <section>
                    <a href="./shopping_cart.html">è¿”å›è³¼ç‰©è»Š</a>
                    <a href="#">
                        <button class="BTN" id="SHOPPINGCARTP2PAY" @click="handlePayment">ä»˜æ¬¾</button>
                    </a>
                </section>
            </section>

        </section>
    </section>
        <!-- ===== TOPæŒ‰éˆ• ===== -->
        <!-- top_btn -->
        @@include('./layout/top_btn.html')
        <!-- top_btn end -->
        
    <script src="./js/vendors/vue/vue.global.js"></script>
    <script src="./js/shopping_cart2.js"></script>
    <script src="./js/top_btn.js"></script>
    <script src="./js/nav.js"></script>
    <script src="./js/user_popup.js"></script>
    <script src="./js/toggle.js"></script>

    <script>
        $(document).ready(function() {
            $('#RECIPIENT').on('blur', function() {
                var recipientInput = $(this);
                var recipientValue = recipientInput.val().trim();
                var errorElement1 = recipientInput.siblings('.INPUTERROR');
                var errorElement2 = recipientInput.siblings('.INPUTERROR2');

                var recipientRegex = /^[\u4E00-\u9FFFa-zA-Z\s]+$/;
                if (recipientValue === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                } else if (recipientValue.length < 2 || !recipientRegex.test(recipientValue)) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#RECIPIENT').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
            });

            $('#CARTINBOX').on('blur', function() {
                var emailInput = $(this);
                var emailValue = emailInput.val().trim();
                var errorElement1 = emailInput.siblings('.INPUTERROR');
                var errorElement2 = emailInput.siblings('.INPUTERROR2');

                var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (emailValue === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                } else if (!emailRegex.test(emailValue)) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#CARTINBOX').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
            });

            $('#RECIPIENTPHONE').on('blur', function() {
                var phoneInput = $(this);
                var phoneValue = phoneInput.val().trim();
                var errorElement1 = phoneInput.siblings('.INPUTERROR');
                var errorElement2 = phoneInput.siblings('.INPUTERROR2');

                var phoneRegex = /^(\+?886-?|0)?9\d{8}$/;

                if (phoneValue === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                } else if (!phoneRegex.test(phoneValue)) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#RECIPIENTPHONE').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
            });
        });

// ===========================================================================

    $(document).ready(function() {
        $('#samemember').change(function() {
            if ($(this).is(':checked')) {
            var memberNameValue = $('#MEMBERNAME').val();
            var memberMailValue = $('#MEMBERMAIL').val();
            var memberPhoneValue = $('#MEMBERPHONE').val();

            $('#RECIPIENT').val(memberNameValue).siblings('.INPUTERROR, .INPUTERROR2').removeClass('WRONG');
            $('#RECIPIENT').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
            $('#CARTINBOX').val(memberMailValue).siblings('.INPUTERROR, .INPUTERROR2').removeClass('WRONG');
            $('#CARTINBOX').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
            $('#RECIPIENTPHONE').val(memberPhoneValue).siblings('.INPUTERROR, .INPUTERROR2').removeClass('WRONG');
            $('#RECIPIENTPHONE').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
            } else {
            $('#RECIPIENT').val('');
            $('#CARTINBOX').val('');
            $('#RECIPIENTPHONE').val('');
            }
        });
    });

// ======================================================================================

    $(document).ready(function() {
        $('#CARDNUMBER').on('input', function() {
            var cardNumber = $(this).val().replace(/-/g, ''); // ç§»é™¤æ‰€æœ‰ç°æœ‰çš„è¿å­—ç¬¦

            if (cardNumber.length > 0) {
            // æ¯å››ä¸ªæ•°å­—æ’å…¥è¿å­—ç¬¦
            var formattedCardNumber = cardNumber.match(/.{1,4}/g).join('-');

            // å¦‚æœæ•°å­—é•¿åº¦è¶…è¿‡16ä½ï¼Œåˆ™ç§»é™¤æœ€åçš„è¿å­—ç¬¦
            if (cardNumber.length > 16) {
                formattedCardNumber = formattedCardNumber.slice(0, -1);
            }

            // å¦‚æœæ ¼å¼åŒ–åçš„å¡å·é•¿åº¦è¶…è¿‡19ä½ï¼Œåˆ™æˆªå–å‰19ä½
            if (formattedCardNumber.length > 19) {
                formattedCardNumber = formattedCardNumber.slice(0, 19);
            }

            $(this).val(formattedCardNumber);
            }
        });
    });

// =======================================================================================

    $(document).ready(function() {
            $('#CARDOWNER').on('blur', function() {
                var cardownerInput = $(this);
                var cardownerValue = cardownerInput.val().trim();
                var errorElement1 = cardownerInput.siblings('.INPUTERROR');
                var errorElement2 = cardownerInput.siblings('.INPUTERROR2');

                var cardownerRegex = /^[\u4E00-\u9FFFa-zA-Z\s]+$/;
                if (cardownerValue === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                } else if (cardownerValue.length < 2 || !cardownerRegex.test(cardownerValue)) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#CARDOWNER').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
            });

            $('#CARDEXPIRYDATE').on('input', function() {
                var cardexpirydateInput = $(this).val();
                var numbers = cardexpirydateInput.replace(/\D/g, ''); // ç§»é™¤éæ•¸å­—å­—ç¬¦

                
                // æ¯å…©å€‹æ•¸å­—æ’å…¥æ–œç·š
                var formatted = numbers.match(/.{1,2}/g).join('/');

                // å¦‚æœé•·åº¦è¶…é5å€‹å­—å…ƒï¼Œå‰‡æˆªæ–·
                if (formatted.length > 5) {
                formatted = formatted.substr(0, 5);
                }

                $(this).val(formatted);
            });

            $('#CARDEXPIRYDATE').on('blur', function() {
                var cardexpirydateInput = $(this);
                var cardexpirydateValue = cardexpirydateInput.val().trim();
                var errorElement1 = cardexpirydateInput.siblings('.INPUTERROR');
                var errorElement2 = cardexpirydateInput.siblings('.INPUTERROR2');

                if (cardexpirydateValue === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                } else if (cardexpirydateValue.length < 4 ) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#CARDEXPIRYDATE').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
            });

            $('#CARDEXPIRYDATE').on('keydown', function(event) {
                var key = event.which || event.keyCode;
                
                // åªå…è¨±æ•¸å­—ã€åˆªé™¤éµå’Œæ–¹å‘éµçš„ä½¿ç”¨
                if (!(key >= 48 && key <= 57) && key !== 8 && key !== 37 && key !== 39) {
                    event.preventDefault();
                }
            });

            $('#CARDCVC').on('input', function() {
                var cardcvcInput = $(this).val();
                var numbers = cardcvcInput.replace(/\D/g, ''); // ç§»é™¤éæ•¸å­—å­—ç¬¦

                // å¦‚æœé•·åº¦è¶…é5å€‹å­—å…ƒï¼Œå‰‡æˆªæ–·
                if (numbers.length > 3) {
                    numbers = numbers.substr(0, 3);
                }

                $(this).val(numbers);
            });

            $('#CARDCVC').on('blur', function() {
                var cardcvcInput = $(this);
                var cardcvcValue = cardcvcInput.val().trim();
                var errorElement1 = cardcvcInput.siblings('.INPUTERROR');
                var errorElement2 = cardcvcInput.siblings('.INPUTERROR2');

                if (cardcvcValue === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                } else if (cardcvcValue.length < 3 ) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#CARDCVC').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
            });

            $('#CARDCVC').on('keydown', function(event) {
                var key = event.which || event.keyCode;
                
                // åªå…è¨±æ•¸å­—ã€åˆªé™¤éµå’Œæ–¹å‘éµçš„ä½¿ç”¨
                if (!(key >= 48 && key <= 57) && key !== 8 && key !== 37 && key !== 39) {
                    event.preventDefault();
                }
            });

// =======================================================================================

            $("#CARDNUMBER").on("input", function() {
                let cardNum = $(this).val();
                let newCardNum = cardNum.replace(/-/g, "");
                let sum = evenNum(newCardNum) + oddNum(newCardNum);
                let resultNum = sum % 10;
                if (resultNum !== 0) {
                    resultNum = 10 - resultNum;
                }

                var errorElement1 = $(this).siblings('.INPUTERROR');
                var errorElement2 = $(this).siblings('.INPUTERROR2');
                if (resultNum !== newCardNum[15] * 1) {
                    errorElement1.removeClass('WRONG');
                    errorElement2.addClass("WRONG");
                } else {
                    errorElement2.removeClass("WRONG");
                    $('#CARDNUMBER').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                }
                });

                // å¶æ•°ä½åŠ æ€»
                function evenNum(newCardNum) {
                let sum = 0;
                for (let i = 1; i <= 13; i += 2) {
                    let resultNum = Number(newCardNum[i]);
                    sum += resultNum;
                }
                return sum;
                }

                // å¥‡æ•°ä½åŠ æ€»
                function oddNum(newCardNum) {
                let sum = 0;
                for (let i = 0; i <= 15; i += 2) {
                    let resultNum = Number(newCardNum[i]) * 2;
                    if (resultNum >= 10) {
                    resultNum -= 9;
                    }
                    sum += resultNum;
                }
                return sum;
                }

                $('#CARDNUMBER').on('blur', function() {
                    var errorElement1 = $(this).siblings('.INPUTERROR');
                    var errorElement2 = $(this).siblings('.INPUTERROR2');

                    if ($(this).val().trim() === '') {
                        errorElement1.addClass('WRONG');
                        errorElement2.removeClass('WRONG');
                    } else if (!errorElement2.hasClass('WRONG')) {
                        errorElement1.removeClass('WRONG');
                        $('#CARDNUMBER').addClass('TRUEOUTLINE').removeClass('ERROROUTLINE');
                    }
                });
        });


    </script>

    <!-- <script>//ä¸‹ä¸€é æŒ‰éˆ•é©—è­‰
        $(document).ready(function() {
            // é»æ“Š SHOPPINGCARTP2PAY æŒ‰éˆ•æ™‚è§¸ç™¼äº‹ä»¶
            $('#SHOPPINGCARTP2PAY').click(function(event) {
                // åœæ­¢è¡¨å–®çš„é è¨­æäº¤è¡Œç‚º
                event.preventDefault();

                // å†æ¬¡åŸ·è¡Œé©—è­‰ä¸¦æª¢æŸ¥æ˜¯å¦é€šé
                if (validateForm()) {
                // é©—è­‰é€šéï¼Œè·³è½‰åˆ°ä¸‹ä¸€é 
                window.location.href = './shopping_cartp3.html';
                }
            });

            function validateForm() {
                var isValid = true;

                // é€²è¡Œæ”¶ä»¶äººå§“å(RECIPIENT)çš„é©—è­‰
                var recipientInput = $('#RECIPIENT');
                var recipientValue = recipientInput.val().trim();
                var errorElement1 = recipientInput.siblings('.INPUTERROR');
                var errorElement2 = recipientInput.siblings('.INPUTERROR2');

                var recipientRegex = /^[\u4E00-\u9FFFa-zA-Z\s]+$/;
                if (recipientValue.trim() === '') {
                errorElement1.addClass('WRONG');
                errorElement2.removeClass('WRONG');
                $('#RECIPIENT').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (recipientValue.length < 2 || !recipientRegex.test(recipientValue)) {
                errorElement1.removeClass('WRONG');
                errorElement2.addClass('WRONG');
                $('#RECIPIENT').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                errorElement1.removeClass('WRONG');
                errorElement2.removeClass('WRONG');
                }

                // é€²è¡Œé›»å­ä¿¡ç®±(CARTINBOX)çš„é©—è­‰
                var emailInput = $('#CARTINBOX');
                var emailValue = emailInput.val().trim();
                var emailErrorElement1 = emailInput.siblings('.INPUTERROR');
                var emailErrorElement2 = emailInput.siblings('.INPUTERROR2');

                var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (emailValue === '') {
                emailErrorElement1.addClass('WRONG');
                emailErrorElement2.removeClass('WRONG');
                $('#CARTINBOX').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (!emailRegex.test(emailValue)) {
                emailErrorElement1.removeClass('WRONG');
                emailErrorElement2.addClass('WRONG');
                $('#CARTINBOX').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                emailErrorElement1.removeClass('WRONG');
                emailErrorElement2.removeClass('WRONG');
                }

                // é€²è¡Œé€£çµ¡æ‰‹æ©Ÿ(RECIPIENTPHONE)çš„é©—è­‰
                var phoneInput = $('#RECIPIENTPHONE');
                var phoneValue = phoneInput.val().trim();
                var phoneErrorElement1 = phoneInput.siblings('.INPUTERROR');
                var phoneErrorElement2 = phoneInput.siblings('.INPUTERROR2');

                var phoneRegex = /^(\+?886-?|0)?9\d{8}$/;
                if (phoneValue === '') {
                phoneErrorElement1.addClass('WRONG');
                phoneErrorElement2.removeClass('WRONG');
                $('#RECIPIENTPHONE').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (!phoneRegex.test(phoneValue)) {
                phoneErrorElement1.removeClass('WRONG');
                phoneErrorElement2.addClass('WRONG');
                $('#RECIPIENTPHONE').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                phoneErrorElement1.removeClass('WRONG');
                phoneErrorElement2.removeClass('WRONG');
                }

                var cardNumberInput = $('#CARDNUMBER');
                var cardNumberValue = cardNumberInput.val().replace(/-/g, ''); // ç§»é™¤æ‰€æœ‰ç¾æœ‰çš„é€£å­—ç¬¦
                var cardNumberErrorElement1 = cardNumberInput.siblings('.INPUTERROR');
                var cardNumberErrorElement2 = cardNumberInput.siblings('.INPUTERROR2');

                if (cardNumberValue === '') {
                cardNumberErrorElement1.addClass('WRONG');
                cardNumberErrorElement2.removeClass('WRONG');
                $('#CARDNUMBER').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (!isValidLuhn(cardNumberValue)) {
                cardNumberErrorElement1.removeClass('WRONG');
                cardNumberErrorElement2.addClass('WRONG');
                $('#CARDNUMBER').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                cardNumberErrorElement1.removeClass('WRONG');
                cardNumberErrorElement2.removeClass('WRONG');
                }

                function isValidLuhn(cardNumber) {
                    let newCardNum = cardNumber.replace(/-/g, "");
                    let sum = evenNum(newCardNum) + oddNum(newCardNum);
                    let resultNum = sum % 10;
                    if (resultNum !== 0) {
                        resultNum = 10 - resultNum;
                    }
                    return resultNum === newCardNum[15] * 1;
                    }

                    // å¶æ•°ä½åŠ æ€»
                    function evenNum(newCardNum) {
                    let sum = 0;
                    for (let i = 1; i <= 13; i += 2) {
                        let resultNum = Number(newCardNum[i]);
                        sum += resultNum;
                    }
                    return sum;
                    }

                    // å¥‡æ•°ä½åŠ æ€»
                    function oddNum(newCardNum) {
                    let sum = 0;
                    for (let i = 0; i <= 15; i += 2) {
                        let resultNum = Number(newCardNum[i]) * 2;
                        if (resultNum >= 10) {
                        resultNum -= 9;
                        }
                        sum += resultNum;
                    }
                    return sum;
                    }

                // é€²è¡ŒæŒå¡äººå§“å(CARDOWNER)çš„é©—è­‰
                var cardOwnerInput = $('#CARDOWNER');
                var cardOwnerValue = cardOwnerInput.val().trim();
                var cardOwnerErrorElement1 = cardOwnerInput.siblings('.INPUTERROR');
                var cardOwnerErrorElement2 = cardOwnerInput.siblings('.INPUTERROR2');

                var cardOwnerRegex = /^[\u4E00-\u9FFFa-zA-Z\s]+$/;
                if (cardOwnerValue === '') {
                cardOwnerErrorElement1.addClass('WRONG');
                cardOwnerErrorElement2.removeClass('WRONG');
                $('#CARDOWNER').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (cardOwnerValue.length < 2 || !cardOwnerRegex.test(cardOwnerValue)) {
                cardOwnerErrorElement1.removeClass('WRONG');
                cardOwnerErrorElement2.addClass('WRONG');
                $('#CARDOWNER').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                cardOwnerErrorElement1.removeClass('WRONG');
                cardOwnerErrorElement2.removeClass('WRONG');
                }

                // é€²è¡Œä¿¡ç”¨å¡æœ‰æ•ˆæœŸé™(CARDEXPIRYDATE)çš„é©—è­‰
                var cardExpiryDateInput = $('#CARDEXPIRYDATE');
                var cardExpiryDateValue = cardExpiryDateInput.val().trim();
                var cardExpiryDateErrorElement1 = cardExpiryDateInput.siblings('.INPUTERROR');
                var cardExpiryDateErrorElement2 = cardExpiryDateInput.siblings('.INPUTERROR2');

                if (cardExpiryDateValue === '') {
                cardExpiryDateErrorElement1.addClass('WRONG');
                cardExpiryDateErrorElement2.removeClass('WRONG');
                $('#CARDEXPIRYDATE').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (cardExpiryDateValue.length < 4) {
                cardExpiryDateErrorElement1.removeClass('WRONG');
                cardExpiryDateErrorElement2.addClass('WRONG');
                $('#CARDEXPIRYDATE').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                cardExpiryDateErrorElement1.removeClass('WRONG');
                cardExpiryDateErrorElement2.removeClass('WRONG');
                }

                // é€²è¡Œä¿¡ç”¨å¡å®‰å…¨ç¢¼(CARDCVC)çš„é©—è­‰
                var cardCVCInput = $('#CARDCVC');
                var cardCVCValue = cardCVCInput.val().trim();
                var cardCVCErrorElement1 = cardCVCInput.siblings('.INPUTERROR');
                var cardCVCErrorElement2 = cardCVCInput.siblings('.INPUTERROR2');

                if (cardCVCValue === '') {
                cardCVCErrorElement1.addClass('WRONG');
                cardCVCErrorElement2.removeClass('WRONG');
                $('#CARDCVC').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else if (cardCVCValue.length < 3) {
                cardCVCErrorElement1.removeClass('WRONG');
                cardCVCErrorElement2.addClass('WRONG');
                $('#CARDCVC').addClass('ERROROUTLINE').removeClass('TRUEOUTLINE');
                isValid = false;
                } else {
                cardCVCErrorElement1.removeClass('WRONG');
                cardCVCErrorElement2.removeClass('WRONG');
                }

                return isValid;

            }



        })
    </script> -->




</body>

</html>